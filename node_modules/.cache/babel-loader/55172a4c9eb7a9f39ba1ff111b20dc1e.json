{"ast":null,"code":"import _regeneratorRuntime from\"/Users/jeff/Desktop/TFG/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/jeff/Desktop/TFG/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{loadingFinished,loadingStarted}from\"www/widgets/LoadingWidget/actions\";import{screenPushed}from\"www/widgets/ScreenStackWidget/actions\";import{postReplaced}from\"./actions\";import{POST_PUSHED}from\"./types\";export var postMiddleware=function postMiddleware(store){return function(next){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(action){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:next(action);if(!(action.type===POST_PUSHED)){_context.next=4;break;}_context.next=4;return postPushed(store,action);case 4:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};};function postPushed(_x2,_x3){return _postPushed.apply(this,arguments);}function _postPushed(){_postPushed=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(store,action){var response,post;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:store.dispatch(loadingStarted());_context2.next=3;return fetch(\"/api/v1/posts/\"+action.postId);case 3:response=_context2.sent;_context2.next=6;return response.json();case 6:post=_context2.sent;store.dispatch(postReplaced(post));store.dispatch(screenPushed(\"post\"));store.dispatch(loadingFinished());case 10:case\"end\":return _context2.stop();}}},_callee2);}));return _postPushed.apply(this,arguments);}","map":{"version":3,"sources":["/Users/jeff/Desktop/TFG/src/www/screens/PostScreen/middleware.ts"],"names":["loadingFinished","loadingStarted","screenPushed","postReplaced","POST_PUSHED","postMiddleware","store","next","action","type","postPushed","dispatch","fetch","postId","response","json","post"],"mappings":"yRAEA,OACEA,eADF,CAEEC,cAFF,KAGO,mCAHP,CAIA,OAASC,YAAT,KAA6B,uCAA7B,CACA,OAASC,YAAT,KAA6B,WAA7B,CACA,OAA2BC,WAA3B,KAA8C,SAA9C,CAEA,MAAO,IAAMC,CAAAA,cAAwC,CACnD,QADWA,CAAAA,cACX,CAACC,KAAD,QAAgB,UAACC,IAAD,iGAAU,iBAAOC,MAAP,kHACxBD,IAAI,CAACC,MAAD,CAAJ,CADwB,KAGpBA,MAAM,CAACC,IAAP,GAAgBL,WAHI,gDAGeM,CAAAA,UAAU,CAACJ,KAAD,CAAQE,MAAR,CAHzB,uDAAV,gEAAhB,EADK,C,QAOQE,CAAAA,U,+IAAf,kBAA0BJ,KAA1B,CAAsCE,MAAtC,wIACEF,KAAK,CAACK,QAAN,CAAeV,cAAc,EAA7B,EADF,uBAGyBW,CAAAA,KAAK,CAAC,iBAAmBJ,MAAM,CAACK,MAA3B,CAH9B,QAGQC,QAHR,uCAIqBA,CAAAA,QAAQ,CAACC,IAAT,EAJrB,QAIQC,IAJR,gBAKEV,KAAK,CAACK,QAAN,CAAeR,YAAY,CAACa,IAAD,CAA3B,EACAV,KAAK,CAACK,QAAN,CAAeT,YAAY,CAAC,MAAD,CAA3B,EAEAI,KAAK,CAACK,QAAN,CAAeX,eAAe,EAA9B,EARF,yD","sourcesContent":["import { Middleware } from \"redux\";\nimport { AppState } from \"www/store\";\nimport {\n  loadingFinished,\n  loadingStarted,\n} from \"www/widgets/LoadingWidget/actions\";\nimport { screenPushed } from \"www/widgets/ScreenStackWidget/actions\";\nimport { postReplaced } from \"./actions\";\nimport { PostPushedAction, POST_PUSHED } from \"./types\";\n\nexport const postMiddleware: Middleware<{}, AppState> =\n  (store: any) => (next) => async (action) => {\n    next(action);\n\n    if (action.type === POST_PUSHED) await postPushed(store, action);\n  };\n\nasync function postPushed(store: any, action: PostPushedAction) {\n  store.dispatch(loadingStarted());\n\n  const response = await fetch(\"/api/v1/posts/\" + action.postId);\n  const post = await response.json();\n  store.dispatch(postReplaced(post));\n  store.dispatch(screenPushed(\"post\"));\n\n  store.dispatch(loadingFinished());\n}\n"]},"metadata":{},"sourceType":"module"}